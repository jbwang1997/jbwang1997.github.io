<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="description"
        content="Towards Stable 3D Object Detection">

  <meta name="keywords" content="3D Object Detection, Stability">

  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>Towards Stable 3D Object Detection</title>
  <script>
    window.dataLayer = window.dataLayer || [];

    function gtag() {
      dataLayer.push(arguments);
    }

    gtag('js', new Date());

    gtag('config', 'G-PYVRSFMDRL');
  </script>

  <link href="https://fonts.googleapis.com/css?family=Google+Sans|Noto+Sans|Castoro"
        rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65" crossorigin="anonymous">


  <link rel="stylesheet" href="./static/css/bulma.min.css">
  <link rel="stylesheet" href="./static/css/bulma-carousel.min.css">
  <link rel="stylesheet" href="./static/css/bulma-slider.min.css">
  <link rel="stylesheet" href="./static/css/fontawesome.all.min.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1/css/academicons.min.css">
  <link rel="stylesheet" href="./static/css/index.css">
  <link rel="stylesheet" href="./static/css/interactive_figures.css">
  
  <!-- <link rel="icon" href="./static/images/favicon.svg"> -->

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script defer src="./static/js/fontawesome.all.min.js"></script>
  <script src="./static/js/bulma-carousel.min.js"></script>
  <script src="./static/js/bulma-slider.min.js"></script>
  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
  <!-- <script src="./static/js/index.js"></script> -->

  <script src="https://kit.fontawesome.com/e8d9e5563c.js" crossorigin="anonymous"></script>

  <script>
    document.addEventListener("DOMContentLoaded", function(event) { 
        //do work
      
      const copyButtonLabel = "Copy BibTex";

      // use a class selector if available
      let blocks = document.querySelectorAll("pre");
      console.log(blocks)
      
      blocks.forEach((block) => {
        // only add button if browser supports Clipboard API
        if (navigator.clipboard) {
          let button = document.createElement("button");
      
          button.innerText = copyButtonLabel;
          button.classList.add("btn");
          button.classList.add("btn-primary");
          button.style.alignContent = "center";
          button.style.textAlign = "center";
          block.parentElement.appendChild(button);
      
          button.addEventListener("click", async () => {
            await copyCode(block, button);
          });
        }
      });
      
      async function copyCode(block, button) {
        let code = block.querySelector("code");
        let text = code.innerText;
      
        await navigator.clipboard.writeText(text);
      
        // visual feedback that task is completed
        button.innerText = "BibTex Copied!";
      
        setTimeout(() => {
          button.innerText = copyButtonLabel;
        }, 1000);
      }
  });
  </script>

  <style>

    pre[class*="language-"] {
      position: relative;
      overflow: auto;
    
      /* make space  */
      margin: 5px 0;
      padding: 1.75rem 0 1.75rem 1rem;
      border-radius: 10px;
    }
    
    pre[class*="language-"] button {
      position: absolute;
      top: 5px;
      right: 5px;
    
      font-size: 0.9rem;
      padding: 0.15rem;
     
    
      border: ridge 1px;
      border-radius: 5px;
      text-shadow: #c4c4c4 0 0 2px;
    }
    
    pre[class*="language-"] button:hover {
      cursor: pointer;  
    }
  </style>
</head>
<body>

<nav class="navbar" role="navigation" aria-label="main navigation">
  <div class="navbar-brand">
    <a role="button" class="navbar-burger" aria-label="menu" aria-expanded="false">
      <span aria-hidden="true"></span>
      <span aria-hidden="true"></span>
      <span aria-hidden="true"></span>
    </a>
  </div>
</nav>


<section class="hero">
  <div class="hero-body">
    <div class="container is-max-desktop">
      <div class="columns is-centered">
        <div class="column has-text-centered">
          <h1 class="title is-1 publication-title">Towards Stable 3D Object Detection</h1>
          <div class="is-size-5 publication-authors">
            <span class="author-block">
              <a href="https://jbwang1997.github.io/">Jiabao Wang<sup>1</sup>*</a>,  </span>
            <span class="author-block">
              <a href="https://irvingmeng.github.io/">Qiang Meng<sup>2</sup>*</a>,  </span>
            <span class="author-block">
              Guochao Liu<sup>2</sup>, </span>
            <span class="author-block">
              Liujiang Yan<sup>2</sup>, </span>
            <span class="author-block">
              Ke Wang<sup>2</sup>, </span>
            <span class="author-block">
              <a href="https://mmcheng.net/cmm/">Ming-Ming Cheng<sup>1,3</sup></a>,  </span>
            <span class="author-block">
              <a href="https://houqb.github.io/">Qibin Hou<sup>1,3</sup>#</a> </span>
          </div>

          <div class="is-size-5 publication-authors">
            <span class="author-block"><sup>1</sup> VCIP, College of Computer Science, Nankai University</span>
          </div>
          <div class="is-size-5 publication-authors">
            <span class="author-block"><sup>2</sup> KargoBot Inc., China</span>
          </div>
          <div class="is-size-5 publication-authors">
            <span class="author-block"><sup>3</sup> NKIARI, Shenzhen Futian</span>
          </div>

          <div class="column has-text-centered">
            <div class="publication-links">

              <!-- Paper Link. -->
              <span class="link-block">
                <a href="https://arxiv.org/abs/xxx.xxxxx" 
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="ai ai-arxiv"></i>
                  </span>
                  <span>arXiv</span>
                </a>
              </span>
              
              <!-- Code Link. -->
              <span class="link-block">
                <a href="https://github.com/jbwang1997/StabilityIndex"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="fab fa-github"></i>
                  </span>
                  <span>Code</span>
                  </a>
              </span>
              
            </div>

          </div>
        </div>
      </div>
    </div>
  </div>
</section>

<section class="section">
  <div class="container is-max-desktop">
    <!-- Abstract. -->
    <div class="columns is-centered has-text-centered">
      <div class="column is-four-fifths">
        <h2 class="title is-3">Abstract</h2>
        <div class="content has-text-justified">
          <p>
            In autonomous driving, the temporal stability of 3D object detection greatly impacts the driving safety.
            However, the detection stability cannot be accessed by existing metrics such as mAP and MOTA, and consequently is less explored by the community.
            To bridge this gap, this work proposes <b>Stability Index (SI)</b>, a new metric that can comprehensively evaluate the stability of 3D detectors in terms of confidence, box localization, extent, and heading.
            By benchmarking state-of-the-art object detectors on the Waymo Open Dataset, SI reveals interesting properties of object stability that have not been previously discovered by other metrics.
            To help models improve their stability, we further introduce a general and effective training strategy, called <b>Prediction Consistency Learning (PCL)</b>.
            PCL essentially encourages the prediction consistency of the same objects under different timestamps and augmentations, leading to enhanced detection stability. 
            Furthermore, we examine the effectiveness of PCL with the widely-used CenterPoint, and achieve a remarkable SI of 86.00 for vehicle class, surpassing the baseline by 5.48.
            We hope our work could serve as a reliable baseline and draw the community's attention to this crucial issue in 3D object detection.
          </p>
        </div>
      </div>
    </div>
  </div>
</section>


<section class="section">
  <div class="container is-max-desktop">
    <div class="columns is-centered">
      <div class="column ">
        <div class="content" style="text-align:center;">

          <h2 class="title is-3 has-text-centered">ðŸ”¥ The Importance of Stability Issues</h2>

            <img src="images/issues.png" class="" style="width: 90%;margin-bottom: 2%;">

            <p style="text-align:center;" class="has-text-justified">
              Detection stability encompasses more than mere robustness; it extends to the broader context of ensuring human safety in autonomous driving. 
              As exemplified in the above figures, unstable detections, on both confidence scores and bounding boxes, can result in abnormal velocity estimated by tracking.
              These erroneous estimations may trigger false judgement on the behaviors of surrounding agents, potentially misleading the ego-vehicle to make improper or even hazardous decisions.
              In addition, systematically complementing poor detection stability requires extra modules (e.g., Kalman filters with carefully and usually manually tuned parameters).
              This not only increases system complexity and latency, but also necessitates tedious engineering efforts.
              As a conclusion, enhancing detection stability is a crucial step towards safe and reliable autonomous driving.
            </p>
        </div>
      </div>
    </div>
  </div>
</section>


<section class="section">
  <div class="container is-max-desktop">
    <div class="columns is-centered">
      <div class="column ">
        <div class="content" style="text-align:center;">

          <h2 class="title is-3 has-text-centered">ðŸš€ 3D Detection Stability Evaluation and Improvment</h2>

          <h2 class="title is-4"> Principles in Stability Metric Design</h2>

          <p style="text-align:center" class="has-text-justified">
            Through the detailed analysis of stability and exploration of potential solutions, we identify four key properties that an effective metric should meet:
            <ul style="text-align:left">
              <li> <i><b>Comprehensiveness:</b></i> The metric should comprehensively reflect influences from all relevant detection elements. </li>
              <li> <i><b>Homogeneity:</b></i> Influences caused by all elements should be well-processed into unified physical units. </li>
              <li> <i><b>Symmetry:</b></i> The metric values should be consistent when applied to both forward and reverse inputs. </li>
              <li> <i><b>Marginal Unimodality:</b></i> For each element with others fixed, the metric should be unimodal w.r.t. its stability. </li>
            </ul>
          </p>

          <h2 class="title is-4"> Stability Index </h2>

          <p style="text-align:center" class="has-text-justified">
            While the IoU is a promising starting point, meeting the four properties de mands careful designs to effectively integrate the confidence score and address the asymmetry and non-unimodality design flows.
            To this end, we introduce schemes of projection with pivot boxes, element decoupling, and stability aggregation, as illustrated in the below figure.
            Ultimately, we assess the stability of object pairs in consecutive frames and denote the metric as <b>Stability Index (SI)</b>.
          </p>

          <img src="images/si_calculation.png" class="" style="width: 90%;margin-bottom: 2%;">

          <p style="text-align:center;" class="has-text-justified">
            In the picture, the orange and blue boxes represent the best matches between the predictions and the ground-truths searched by the Hungarian algorithm.
            These boxes are subsequently associated across frames using their object ID labels.
            After projecting predictions into a pre-built pivot box, SI decouples them into element-wise computations, which are then aggregated for the final assessment of detection stability.
            For the details of the procedure of computing SI, please refer to our paper.
          </p>

          <h2 class="title is-4"> Prediction Consistency Learning </h2>

          <p style="text-align:center;" class="has-text-justified">
            Beyond the design of the metric, we further attempt to boost the detection stability of 3D object detectors.
            For this purpose, we introduce a general and effective training strategy named <b>Consistency Learning (PCL)</b>, as illustrated in the below figure.
            Our PCL is built on the core idea of encouraging prediction consistency across frames under various augmentations and timestamps.
            It consists of four key stages: neighborhood sampling, prediction pairing, de-augmentation, and prediction consistency loss.
          </p>

          <img src="images/structure.png" class="" style="width: 90%;margin-bottom: 2%;">
          
          <p style="text-align:center;" class="has-text-justified">
            In each iteration, PCL samples a pair of frames at neighboring timestamps <i>t</i> and <i>t'</i>, and applies augmentations M and M' to the paired samples.
            GT-prediction matching and cross-frame matching then collaboratively associate the detector's predictions from the same objects between the two frames.
            After the de-augmentation procedure, PCL calculates the prediction errors in terms of confidence, localization, extent, and heading, which are defined in the object self-coordinate system.
            Finally, PCL penalizes the error disparities among all prediction pairs to enforce the temporal consistency.
            In the figure, pred. and aug. represent prediction and augmentation, respectively.
          </p>
        </div>
      </div>
    </div>
  </div>
</section>


<section class="section" id="dataset-browser">
    <div class="container is-max-desktop">
      <div class="columns is-centered">
        <!-- Visual Effects. -->
        <div class="column">
          <div class="content" style="text-align:center;">
            <h2 class="title is-3 has-text-centered">ðŸ“º Quantitative and Qualitative Results</h2>

            <h2 class="title is-4"> Benchmark on the Waymo Open Dataset </h2>

            <img src="images/benchmark.jpg" class="" style="width: 90%;margin-bottom: 2%;">

            <h2 class="title is-4"> Analysis on the Waymo Open Dataset </h2>

            <img src="images/relationship.png" class="" style="width: 90%;margin-bottom: 2%;">

            <p style="text-align:center;" class="has-text-justified">
              The above figure shows how various object properties affect detection stability. We group objects based on specified properties and detect them with CenterPoint.
              (a) presents a negative relationship between detection stability and object distance, where longer distances correspond to harder objects to learn in general.
              For all classes, SI increases with the number of object points and becomes saturated when the point number reaches 53, as demonstrated in (b).
              (c) and (d) further explore the effects of object volumes and length-to-width ratios for vehicles.
              We find that small vehicles tend to have more stable detection. Vehicles with length-to-width ratios between 2 and 3 exhibit relatively high SI values.
              This may be attributed to the prevalence of such vehicles in real-world scenarios.
              Vehicles with larger length-to-width ratios, such as trucks/trams/buses, are relatively scarcer in the dataset, and require larger receptive field requirements, making them more unstable in detection.
            </p>

            <h2 class="title is-4"> Results of PCL </h2>

            <table align="center" style="width: 90%;margin-bottom: 2%;">
              <td><img src="images/pcl_tempral.jpg" border="0"></td>
              <td><img src="images/pcl_ablation.jpg" border="0"></td>
            </table>

            <h2 class="title is-4"> Visualizations </h2>

            <img src="images/visualization.png" class="" style="width: 90%;margin-bottom: 2%;">

            <p style="text-align:center;" class="has-text-justified">
              In the above figure, we present visualizations of a few ground-truth data and detection results from three distinct models: the baseline CenterPoint, CenterPoint with 2 frames as input, and our PCL model with n = 16.
              In the first row, we plot the trends in confidence scores with time changes and find the PCL model exhibits superior capability in suppressing confidence score fluctuations compared to the other two models.
              For the predicted boxes, PCL also has more stable results than other models.
              It's noteworthy that our PCL model, despite having a lower mAP compared to the multi-frame version of CenterPoint, significantly outperforms it in terms of SI.
              This further verifies that detection accuracy and stability capture independent aspects of model performance.
              These phenomena all demonstrate the effectiveness of PCL in enhancing detection stability.
              We further visualize the stability of detections in terms of confidence, localization, extent, and heading, as shown in the following table.
            </p>

            <p style="text-align:center;" class="has-text-justified">
              We further visualize the stability of detections in terms of confidence, localization, extent, and heading, as shown in the following table.
            </p>

            <table align="center" style="width: 90%;margin-bottom: 2%;">
              <tr>
                <td align="center">Confidence</td>
                <td align="center">Localization</td>
              </tr>
              <tr>
                <td align="center"> 
                  <img src="images/demo_confidence.gif">
                </td>
                <td align="center">
                  <img src="images/demo_localization.gif">
                </td>
              </tr>
              <tr>
                <td align="center">Extent</td>
                <td align="center">Heading</td>
              </tr>
              <tr>
                <td align="center">
                  <img src="images/demo_extent.gif">
                </td>
                <td align="center">
                  <img src="images/demo_heading.gif">
                </td>
              </tr>
            </table>

            <p style="text-align:center;" class="has-text-justified">
            </p>
        </div>
      </div>
    </div>
</section>

<section class="section">
  <div class="container is-max-desktop">
    <div class="columns is-centered">
      <div class="column">
        <div class="content">
          <h2 class="title is-3  has-text-centered">ðŸ“– Citation</h2>
            <div class="language-css">
            <pre style="">
<code>
@inproceedings{wang2024towards,
  title={Towards stable 3d object detection},
  author={Wang, Jiabao and Meng, Qiang and Liu, Guochao and Yan, Liujiang and Wang, Ke and Cheng, Ming-Ming and Hou, Qibin},
  booktitle={European conference on computer vision},
  year={2024},
  organization={Springer}
}
 </code></pre>
          </div>
        </div>
      </div>
    </div>

  </div>
</section>

<footer class="footer">
  <div class="container">
    <div class="content has-text-centered">
    </div>
    <div class="columns is-centered">
      <div class="column is-8">
        <div class="content">
          <p>
            This website is based on the <a href="https://nerfies.github.io/">Nerfies website template</a>, which is licensed under a
            <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">Creative
            Commons Attribution-ShareAlike 4.0 International License</a>.
          </p>
        </div>
      </div>
    </div>
  </div>
</footer>


<script src="./static/js/interactive_figures.js"></script>
</body>
</html>